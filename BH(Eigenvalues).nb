(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     68719,       1402]
NotebookOptionsPosition[     65269,       1337]
NotebookOutlinePosition[     65602,       1352]
CellTagsIndexPosition[     65559,       1349]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Solve tight bonding Hamiltonian of bilayer honeycomb \
lattice with spin-orbit coupling;", "Subchapter"]], "Subsubsection",
 CellChangeTimes->{{3.77565355175121*^9, 3.77565359373658*^9}, 
   3.775654446949041*^9},
 Background->GrayLevel[
  0.85],ExpressionUUID->"320aea46-9812-4d7f-b7fd-c50bb06b68b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Get", "[", "\"\<EneSpecSOC.mx\>\"", "]"}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7497885233238225`*^9, 3.749788575084713*^9}, {
   3.7497886527728496`*^9, 3.74978865870086*^9}, {3.7497886996041317`*^9, 
   3.7497887459206133`*^9}, {3.749788783298279*^9, 3.74978880125391*^9}, {
   3.7497888633576193`*^9, 3.74978887483924*^9}, {3.749791581283396*^9, 
   3.7497916236842704`*^9}, 3.7497917058652143`*^9, {3.7497920440124083`*^9, 
   3.7497920466644135`*^9}, {3.7497920775680676`*^9, 
   3.7497921126213293`*^9}, {3.7497921462161884`*^9, 3.749792168054227*^9}, {
   3.7497928669690614`*^9, 3.7497929883684745`*^9}, {3.7498756324303713`*^9, 
   3.749875634723575*^9}, {3.749875723924532*^9, 3.749875727886939*^9}, {
   3.749876006475029*^9, 3.7498760138382416`*^9}, {3.749878992289073*^9, 
   3.7498790675904055`*^9}, {3.749879946215149*^9, 3.7498799510823574`*^9}, {
   3.7498802687089157`*^9, 3.7498805544546175`*^9}, {3.749880717585104*^9, 
   3.749880723450714*^9}, {3.7498813869364843`*^9, 3.749881393691296*^9}, {
   3.7498818557329073`*^9, 3.7498819562302837`*^9}, {3.7498822620708213`*^9, 
   3.749882265019226*^9}, {3.7498835791147366`*^9, 3.7498835812675405`*^9}, 
   3.7498882545484343`*^9, {3.750219373509694*^9, 3.750219376327855*^9}, {
   3.750219786524317*^9, 3.750219788656439*^9}, {3.7502202491447773`*^9, 
   3.750220251622919*^9}, {3.7502205218343744`*^9, 3.7502205872291145`*^9}, {
   3.750236386722456*^9, 3.7502364033988853`*^9}, {3.750237826573785*^9, 
   3.750237826948186*^9}, {3.750237879816678*^9, 3.7502378942779036`*^9}, 
   3.7511633369945087`*^9, {3.751163384259794*^9, 3.7511634017982254`*^9}, 
   3.7511652905914345`*^9, {3.751165373117183*^9, 3.7511653835390015`*^9}, 
   3.7511654451325665`*^9, 3.751268739799609*^9, {3.751269445875994*^9, 
   3.7512694610778637`*^9}, 3.7512697693574963`*^9, {3.7516477056087317`*^9, 
   3.7516477286175737`*^9}, {3.7516923857619095`*^9, 3.751692399077134*^9}, {
   3.7571346764335957`*^9, 3.757134693016425*^9}, 3.75723906762848*^9, {
   3.7643441099159813`*^9, 3.76434411587464*^9}, {3.764344255481247*^9, 
   3.7643442663512783`*^9}, 3.764355875250908*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"0a2c22de-36d5-421b-8907-aab276a9d1b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Define nearest neighbors and second nearest neighbors vectors;\
\>", "Subsubsection",
 CellChangeTimes->{3.775653527464106*^9, 3.775654449110611*^9},
 Background->GrayLevel[
  0.85],ExpressionUUID->"bfa3e814-7027-4d28-97d6-3c8129d7f4d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a1", "=", 
   RowBox[{"a", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}], ";", " ", 
  RowBox[{"a2", "=", 
   RowBox[{"a", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       SqrtBox["3"], "2"], ",", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]}], "}"}]}]}], ";", 
  RowBox[{"a3", "=", 
   RowBox[{"a", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SqrtBox["3"], "2"]}], ",", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d1", "=", 
   RowBox[{"{", 
    RowBox[{
     SqrtBox["3"], ",", "0"}], "}"}]}], ";", 
  RowBox[{"d2", "=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SqrtBox["3"], "2"], ",", 
     RowBox[{"-", 
      FractionBox["3", "2"]}]}], "}"}]}], ";", 
  RowBox[{"d3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SqrtBox["3"], "2"]}], ",", 
     RowBox[{"-", 
      FractionBox["3", "2"]}]}], "}"}]}], ";", 
  RowBox[{"d4", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      SqrtBox["3"]}], ",", "0"}], "}"}]}], ";", 
  RowBox[{"d5", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SqrtBox["3"], "2"]}], ",", 
     FractionBox["3", "2"]}], "}"}]}], ";", 
  RowBox[{"d6", "=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SqrtBox["3"], "2"], ",", 
     FractionBox["3", "2"]}], "}"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7497885233238225`*^9, 3.749788575084713*^9}, {
   3.7497886527728496`*^9, 3.74978865870086*^9}, {3.7497886996041317`*^9, 
   3.7497887459206133`*^9}, {3.749788783298279*^9, 3.74978880125391*^9}, {
   3.7497888633576193`*^9, 3.74978887483924*^9}, {3.749791581283396*^9, 
   3.7497916236842704`*^9}, 3.7497917058652143`*^9, {3.7497920440124083`*^9, 
   3.7497920466644135`*^9}, {3.7497920775680676`*^9, 
   3.7497921126213293`*^9}, {3.7497921462161884`*^9, 3.749792168054227*^9}, {
   3.7497928669690614`*^9, 3.7497929883684745`*^9}, {3.7498756324303713`*^9, 
   3.749875634723575*^9}, {3.749875723924532*^9, 3.749875727886939*^9}, {
   3.749876006475029*^9, 3.7498760138382416`*^9}, {3.749878992289073*^9, 
   3.7498790675904055`*^9}, {3.749879946215149*^9, 3.7498799510823574`*^9}, {
   3.7498802687089157`*^9, 3.7498805544546175`*^9}, {3.749880717585104*^9, 
   3.749880723450714*^9}, {3.7498813869364843`*^9, 3.749881393691296*^9}, {
   3.7498818557329073`*^9, 3.7498819562302837`*^9}, {3.7498822620708213`*^9, 
   3.749882265019226*^9}, {3.7498835791147366`*^9, 3.7498835812675405`*^9}, 
   3.7498882545484343`*^9, {3.750219373509694*^9, 3.750219376327855*^9}, {
   3.750219786524317*^9, 3.750219788656439*^9}, {3.7502202491447773`*^9, 
   3.750220251622919*^9}, {3.7502205218343744`*^9, 3.7502205872291145`*^9}, {
   3.750236386722456*^9, 3.7502364033988853`*^9}, {3.750237826573785*^9, 
   3.750237826948186*^9}, {3.750237879816678*^9, 3.7502378942779036`*^9}, 
   3.7511633369945087`*^9, {3.751163384259794*^9, 3.7511634017982254`*^9}, 
   3.7511652905914345`*^9, {3.751165373117183*^9, 3.7511653835390015`*^9}, 
   3.7511654451325665`*^9, 3.751268739799609*^9, {3.751269445875994*^9, 
   3.7512694610778637`*^9}, 3.7512697693574963`*^9, {3.7516477056087317`*^9, 
   3.7516477286175737`*^9}, {3.7516923857619095`*^9, 3.751692399077134*^9}, {
   3.7571346764335957`*^9, 3.757134693016425*^9}, {3.75723906762848*^9, 
   3.7572390743052917`*^9}, {3.758604196180853*^9, 3.758604197023741*^9}, {
   3.758604827630329*^9, 3.75860485151748*^9}, {3.758873498614388*^9, 
   3.758873520644109*^9}, {3.758873669910099*^9, 3.758873690321392*^9}, 
   3.758874051933025*^9, 3.758874213822904*^9, {3.758877257401375*^9, 
   3.75887726409789*^9}, {3.758898848620735*^9, 3.7588988790343924`*^9}, {
   3.7589595325515947`*^9, 3.758959547977894*^9}, {3.7621069849819508`*^9, 
   3.762107076273663*^9}, {3.762107199579204*^9, 3.7621072487555304`*^9}, {
   3.7621072928487387`*^9, 3.762107307852293*^9}, 3.7623434316153173`*^9, 
   3.762343501202488*^9, {3.775653341127287*^9, 3.775653390022399*^9}, {
   3.775653503038368*^9, 3.7756535364159737`*^9}, {3.7756536860900583`*^9, 
   3.7756537064368362`*^9}},ExpressionUUID->"eca7f318-e3b2-40b0-8b06-\
d533bb7402a9"]
}, Open  ]],

Cell["Define the phase of the hoppings;", "Subsubsection",
 CellChangeTimes->{{3.775653720796669*^9, 3.775653746573892*^9}, 
   3.775654443295217*^9},
 Background->GrayLevel[
  0.85],ExpressionUUID->"48fdbcb2-f864-4b37-ba70-e00f3b44d4d7"],

Cell[CellGroupData[{

Cell["Nearest neighbour hopping,", "Subsubsection",
 CellChangeTimes->{{3.775653954187161*^9, 3.775653965346616*^9}, {
   3.775654027317609*^9, 3.7756540284649563`*^9}, 3.775654429206505*^9},
 FontSize->14,
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"777ea59e-a9aa-4065-848a-82bd8978bc04"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kx", ",", "ky"}], "}"}], ".", "a1"}]}], "]"}], "+", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kx", ",", "ky"}], "}"}], ".", "a2"}]}], "]"}], "+", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kx", ",", "ky"}], "}"}], ".", "a3"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7497885233238225`*^9, 3.749788575084713*^9}, {
   3.7497886527728496`*^9, 3.74978865870086*^9}, {3.7497886996041317`*^9, 
   3.7497887459206133`*^9}, {3.749788783298279*^9, 3.74978880125391*^9}, {
   3.7497888633576193`*^9, 3.74978887483924*^9}, {3.749791581283396*^9, 
   3.7497916236842704`*^9}, 3.7497917058652143`*^9, {3.7497920440124083`*^9, 
   3.7497920466644135`*^9}, {3.7497920775680676`*^9, 
   3.7497921126213293`*^9}, {3.7497921462161884`*^9, 3.749792168054227*^9}, {
   3.7497928669690614`*^9, 3.7497929883684745`*^9}, {3.7498756324303713`*^9, 
   3.749875634723575*^9}, {3.749875723924532*^9, 3.749875727886939*^9}, {
   3.749876006475029*^9, 3.7498760138382416`*^9}, {3.749878992289073*^9, 
   3.7498790675904055`*^9}, {3.749879946215149*^9, 3.7498799510823574`*^9}, {
   3.7498802687089157`*^9, 3.7498805544546175`*^9}, {3.749880717585104*^9, 
   3.749880723450714*^9}, {3.7498813869364843`*^9, 3.749881393691296*^9}, {
   3.7498818557329073`*^9, 3.7498819562302837`*^9}, {3.7498822620708213`*^9, 
   3.749882265019226*^9}, {3.7498835791147366`*^9, 3.7498835812675405`*^9}, 
   3.7498882545484343`*^9, {3.750219373509694*^9, 3.750219376327855*^9}, {
   3.750219786524317*^9, 3.750219788656439*^9}, {3.7502202491447773`*^9, 
   3.750220251622919*^9}, {3.7502205218343744`*^9, 3.7502205872291145`*^9}, {
   3.750236386722456*^9, 3.7502364033988853`*^9}, {3.750237826573785*^9, 
   3.750237826948186*^9}, {3.750237879816678*^9, 3.7502378942779036`*^9}, 
   3.7511633369945087`*^9, {3.751163384259794*^9, 3.7511634017982254`*^9}, 
   3.7511652905914345`*^9, {3.751165373117183*^9, 3.7511653835390015`*^9}, 
   3.7511654451325665`*^9, 3.751268739799609*^9, {3.751269445875994*^9, 
   3.7512694610778637`*^9}, 3.7512697693574963`*^9, {3.7516477056087317`*^9, 
   3.7516477286175737`*^9}, {3.7516923857619095`*^9, 3.751692399077134*^9}, {
   3.7571346764335957`*^9, 3.757134693016425*^9}, {3.75723906762848*^9, 
   3.7572390743052917`*^9}, {3.758604196180853*^9, 3.758604197023741*^9}, {
   3.758604827630329*^9, 3.75860485151748*^9}, {3.758873498614388*^9, 
   3.758873520644109*^9}, {3.758873669910099*^9, 3.758873690321392*^9}, 
   3.758874051933025*^9, 3.758874213822904*^9, {3.758877257401375*^9, 
   3.75887726409789*^9}, {3.758898848620735*^9, 3.7588988790343924`*^9}, {
   3.7589595325515947`*^9, 3.758959547977894*^9}, {3.7621069849819508`*^9, 
   3.762107076273663*^9}, {3.762107199579204*^9, 3.7621072487555304`*^9}, {
   3.7621072928487387`*^9, 3.762107307852293*^9}, 3.7623434316153173`*^9, 
   3.762343501202488*^9, {3.775653341127287*^9, 3.775653390022399*^9}, {
   3.775653503038368*^9, 3.7756535364159737`*^9}, {3.7756536860900583`*^9, 
   3.7756537064368362`*^9}, {3.7756537999795237`*^9, 
   3.7756539463609447`*^9}, {3.775653999248114*^9, 
   3.775654012272456*^9}},ExpressionUUID->"87af1a62-f588-4db6-9739-\
a0feb7b0a0b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Intrinsic second neighbour coupling phase,", "Subsubsection",
 CellChangeTimes->{{3.775653954187161*^9, 3.775653965346616*^9}, {
   3.775654023430108*^9, 3.7756540537845984`*^9}, 3.7756544303666277`*^9},
 FontSize->14,
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"2df4d14c-995b-48fa-ac9a-891a304bf544"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dhi", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"kx", ",", "ky"}], "}"}], ".", "d1"}]}], "]"}], ")"}]}], 
    "+", 
    RowBox[{"(", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky"}], "}"}], ".", "d2"}]}], "]"}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky"}], "}"}], ".", "d3"}]}], "]"}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky"}], "}"}], ".", "d4"}]}], "]"}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky"}], "}"}], ".", "d5"}]}], "]"}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky"}], "}"}], ".", "d6"}]}], "]"}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7497885233238225`*^9, 3.749788575084713*^9}, {
   3.7497886527728496`*^9, 3.74978865870086*^9}, {3.7497886996041317`*^9, 
   3.7497887459206133`*^9}, {3.749788783298279*^9, 3.74978880125391*^9}, {
   3.7497888633576193`*^9, 3.74978887483924*^9}, {3.749791581283396*^9, 
   3.7497916236842704`*^9}, 3.7497917058652143`*^9, {3.7497920440124083`*^9, 
   3.7497920466644135`*^9}, {3.7497920775680676`*^9, 
   3.7497921126213293`*^9}, {3.7497921462161884`*^9, 3.749792168054227*^9}, {
   3.7497928669690614`*^9, 3.7497929883684745`*^9}, {3.7498756324303713`*^9, 
   3.749875634723575*^9}, {3.749875723924532*^9, 3.749875727886939*^9}, {
   3.749876006475029*^9, 3.7498760138382416`*^9}, {3.749878992289073*^9, 
   3.7498790675904055`*^9}, {3.749879946215149*^9, 3.7498799510823574`*^9}, {
   3.7498802687089157`*^9, 3.7498805544546175`*^9}, {3.749880717585104*^9, 
   3.749880723450714*^9}, {3.7498813869364843`*^9, 3.749881393691296*^9}, {
   3.7498818557329073`*^9, 3.7498819562302837`*^9}, {3.7498822620708213`*^9, 
   3.749882265019226*^9}, {3.7498835791147366`*^9, 3.7498835812675405`*^9}, 
   3.7498882545484343`*^9, {3.750219373509694*^9, 3.750219376327855*^9}, {
   3.750219786524317*^9, 3.750219788656439*^9}, {3.7502202491447773`*^9, 
   3.750220251622919*^9}, {3.7502205218343744`*^9, 3.7502205872291145`*^9}, {
   3.750236386722456*^9, 3.7502364033988853`*^9}, {3.750237826573785*^9, 
   3.750237826948186*^9}, {3.750237879816678*^9, 3.7502378942779036`*^9}, 
   3.7511633369945087`*^9, {3.751163384259794*^9, 3.7511634017982254`*^9}, 
   3.7511652905914345`*^9, {3.751165373117183*^9, 3.7511653835390015`*^9}, 
   3.7511654451325665`*^9, 3.751268739799609*^9, {3.751269445875994*^9, 
   3.7512694610778637`*^9}, 3.7512697693574963`*^9, {3.7516477056087317`*^9, 
   3.7516477286175737`*^9}, {3.7516923857619095`*^9, 3.751692399077134*^9}, {
   3.7571346764335957`*^9, 3.757134693016425*^9}, {3.75723906762848*^9, 
   3.7572390743052917`*^9}, {3.758604196180853*^9, 3.758604197023741*^9}, {
   3.758604827630329*^9, 3.75860485151748*^9}, {3.758873498614388*^9, 
   3.758873520644109*^9}, {3.758873669910099*^9, 3.758873690321392*^9}, 
   3.758874051933025*^9, 3.758874213822904*^9, {3.758877257401375*^9, 
   3.75887726409789*^9}, {3.758898848620735*^9, 3.7588988790343924`*^9}, {
   3.7589595325515947`*^9, 3.758959547977894*^9}, {3.7621069849819508`*^9, 
   3.762107076273663*^9}, {3.762107199579204*^9, 3.7621072487555304`*^9}, {
   3.7621072928487387`*^9, 3.762107307852293*^9}, 3.7623434316153173`*^9, 
   3.762343501202488*^9, {3.775653341127287*^9, 3.775653390022399*^9}, {
   3.775653503038368*^9, 3.7756535364159737`*^9}, {3.7756536860900583`*^9, 
   3.7756537064368362`*^9}, {3.7756537999795237`*^9, 
   3.7756539463609447`*^9}, {3.775653999248114*^9, 3.775654012272456*^9}, 
   3.775654063287271*^9},ExpressionUUID->"7d96752e-a1d3-4776-8535-\
f2534da24025"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rashba first neighbour coupling phase.", "Subsubsection",
 CellChangeTimes->{{3.775653954187161*^9, 3.775653965346616*^9}, {
  3.775654077627201*^9, 3.775654089568033*^9}, {3.7756544312089357`*^9, 
  3.7756544329312363`*^9}},
 FontSize->14,
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"b7ea74eb-ba92-4abb-b55e-b7f54a3b2d78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rud", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kx", ",", "ky"}], "}"}], ".", "a1"}]}], "]"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"-", "1"}], "2"], "-", " ", 
       RowBox[{"\[ImaginaryI]", " ", 
        FractionBox[
         SqrtBox["3"], "2"]}]}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky"}], "}"}], ".", "a2"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"-", "1"}], "2"], "+", " ", 
       RowBox[{"\[ImaginaryI]", " ", 
        FractionBox[
         SqrtBox["3"], "2"]}]}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky"}], "}"}], ".", "a3"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rdu", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kx", ",", "ky"}], "}"}], ".", "a1"}]}], "]"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"-", "1"}], "2"], "+", " ", 
       RowBox[{"\[ImaginaryI]", " ", 
        FractionBox[
         SqrtBox["3"], "2"]}]}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky"}], "}"}], ".", "a2"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"-", "1"}], "2"], "-", " ", 
       RowBox[{"\[ImaginaryI]", " ", 
        FractionBox[
         SqrtBox["3"], "2"]}]}], ")"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky"}], "}"}], ".", "a3"}]}], "]"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7497885233238225`*^9, 3.749788575084713*^9}, {
   3.7497886527728496`*^9, 3.74978865870086*^9}, {3.7497886996041317`*^9, 
   3.7497887459206133`*^9}, {3.749788783298279*^9, 3.74978880125391*^9}, {
   3.7497888633576193`*^9, 3.74978887483924*^9}, {3.749791581283396*^9, 
   3.7497916236842704`*^9}, 3.7497917058652143`*^9, {3.7497920440124083`*^9, 
   3.7497920466644135`*^9}, {3.7497920775680676`*^9, 
   3.7497921126213293`*^9}, {3.7497921462161884`*^9, 3.749792168054227*^9}, {
   3.7497928669690614`*^9, 3.7497929883684745`*^9}, {3.7498756324303713`*^9, 
   3.749875634723575*^9}, {3.749875723924532*^9, 3.749875727886939*^9}, {
   3.749876006475029*^9, 3.7498760138382416`*^9}, {3.749878992289073*^9, 
   3.7498790675904055`*^9}, {3.749879946215149*^9, 3.7498799510823574`*^9}, {
   3.7498802687089157`*^9, 3.7498805544546175`*^9}, {3.749880717585104*^9, 
   3.749880723450714*^9}, {3.7498813869364843`*^9, 3.749881393691296*^9}, {
   3.7498818557329073`*^9, 3.7498819562302837`*^9}, {3.7498822620708213`*^9, 
   3.749882265019226*^9}, {3.7498835791147366`*^9, 3.7498835812675405`*^9}, 
   3.7498882545484343`*^9, {3.750219373509694*^9, 3.750219376327855*^9}, {
   3.750219786524317*^9, 3.750219788656439*^9}, {3.7502202491447773`*^9, 
   3.750220251622919*^9}, {3.7502205218343744`*^9, 3.7502205872291145`*^9}, {
   3.750236386722456*^9, 3.7502364033988853`*^9}, {3.750237826573785*^9, 
   3.750237826948186*^9}, {3.750237879816678*^9, 3.7502378942779036`*^9}, 
   3.7511633369945087`*^9, {3.751163384259794*^9, 3.7511634017982254`*^9}, 
   3.7511652905914345`*^9, {3.751165373117183*^9, 3.7511653835390015`*^9}, 
   3.7511654451325665`*^9, 3.751268739799609*^9, {3.751269445875994*^9, 
   3.7512694610778637`*^9}, 3.7512697693574963`*^9, {3.7516477056087317`*^9, 
   3.7516477286175737`*^9}, {3.7516923857619095`*^9, 3.751692399077134*^9}, {
   3.7571346764335957`*^9, 3.757134693016425*^9}, {3.75723906762848*^9, 
   3.7572390743052917`*^9}, {3.758604196180853*^9, 3.758604197023741*^9}, {
   3.758604827630329*^9, 3.75860485151748*^9}, {3.758873498614388*^9, 
   3.758873520644109*^9}, {3.758873669910099*^9, 3.758873690321392*^9}, 
   3.758874051933025*^9, 3.758874213822904*^9, {3.758877257401375*^9, 
   3.75887726409789*^9}, {3.758898848620735*^9, 3.7588988790343924`*^9}, {
   3.7589595325515947`*^9, 3.758959547977894*^9}, {3.7621069849819508`*^9, 
   3.762107076273663*^9}, {3.762107199579204*^9, 3.7621072487555304`*^9}, {
   3.7621072928487387`*^9, 3.762107307852293*^9}, 3.7623434316153173`*^9, 
   3.762343501202488*^9, {3.775653341127287*^9, 3.775653390022399*^9}, {
   3.775653503038368*^9, 3.7756535364159737`*^9}, {3.7756536860900583`*^9, 
   3.7756537064368362`*^9}, {3.7756537999795237`*^9, 
   3.7756539463609447`*^9}, {3.775653999248114*^9, 3.775654012272456*^9}, 
   3.775654063287271*^9},ExpressionUUID->"12726435-46fb-46b7-8eb4-\
aeffb3e295d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define the Kernel of the tight bonding Hamiltonian;", "Subsubsection",
 CellChangeTimes->{{3.775653720796669*^9, 3.775653746573892*^9}, {
   3.775654119635598*^9, 3.77565414702024*^9}, 3.77565445289816*^9},
 Background->GrayLevel[
  0.85],ExpressionUUID->"b94bd2bc-51ab-4f39-a733-75ff3a989628"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"hMatrix", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ti", "*", "\[ImaginaryI]", "*", 
          RowBox[{"dhi", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0", " ", ",", 
         RowBox[{
          RowBox[{"-", "t"}], "*", 
          RowBox[{"phi", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
         RowBox[{"tr", "*", "\[ImaginaryI]", "*", 
          RowBox[{"rud", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "ti"}], "*", "\[ImaginaryI]", "*", 
          RowBox[{"dhi", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
         RowBox[{"tr", "*", "\[ImaginaryI]", "*", 
          RowBox[{"rdu", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "t"}], "*", 
          RowBox[{"phi", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "t"}], "*", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"phi", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "tr"}], "*", "\[ImaginaryI]", "*", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"rdu", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "ti"}], "*", "\[ImaginaryI]", "*", 
          RowBox[{"dhi", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "tr"}], "*", "\[ImaginaryI]", "*", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"rud", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "t"}], "*", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"phi", "[", 
            RowBox[{"kx", ",", "ky"}], "]"}], "]"}]}], ",", "0", ",", 
         RowBox[{"ti", "*", "\[ImaginaryI]", "*", 
          RowBox[{"dhi", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hMatrix", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"ExpToTrig", "[", "hMatrix", "]"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "ti", ",", "tr", ",", "a", ",", "kx", ",", "ky"}],
           "}"}], "\[Element]", "Reals"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7571348953487806`*^9, 3.7571349345672493`*^9}, {
   3.758604220259617*^9, 3.758604226293264*^9}, {3.7586042723363647`*^9, 
   3.758604276492651*^9}, 3.7586048659270678`*^9, {3.758604984799974*^9, 
   3.758605022930592*^9}, 3.75860506714701*^9, {3.758605130975121*^9, 
   3.7586051366174307`*^9}, {3.758606799635928*^9, 3.758606872083205*^9}, {
   3.75860691074584*^9, 3.758606911347351*^9}, {3.758607471038289*^9, 
   3.75860748704047*^9}, {3.7586124249024153`*^9, 3.7586124251740303`*^9}, {
   3.758612640531579*^9, 3.758612646923764*^9}, {3.758843968111046*^9, 
   3.75884397373143*^9}, 3.758874059288872*^9, {3.7588740919807568`*^9, 
   3.7588741143631907`*^9}, {3.758874191228794*^9, 3.758874239678529*^9}, 
   3.758876189848308*^9, {3.758877244693783*^9, 3.758877272777001*^9}, {
   3.7588795006367083`*^9, 3.758879515760109*^9}, {3.758888774626913*^9, 
   3.7588887760912447`*^9}, {3.758898891254992*^9, 3.758898911129705*^9}, {
   3.758898979754633*^9, 3.75889898250988*^9}, {3.75889902375564*^9, 
   3.75889909127168*^9}, 3.7588992229357157`*^9, {3.7588994032546883`*^9, 
   3.7588994258439083`*^9}, {3.758954112298889*^9, 3.758954112857074*^9}, {
   3.762108356022113*^9, 3.762108368451837*^9}, {3.7621084357897043`*^9, 
   3.7621085192555647`*^9}, {3.7621085598571*^9, 3.76210856055678*^9}, {
   3.762109383269046*^9, 3.762109387411852*^9}, {3.762110709859378*^9, 
   3.7621107134074287`*^9}, {3.7622532654023027`*^9, 3.762253280055745*^9}, {
   3.762343392226036*^9, 3.76234340894427*^9}, 
   3.775653347447794*^9},ExpressionUUID->"f134a2f8-f872-4295-ae0c-\
2cb2c01124c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hkInterLayer", "=", 
   RowBox[{"tp", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.7526250458258452`*^9, 3.758793874456485*^9, {3.758877338131715*^9, 
   3.758877379348233*^9}, {3.758894018127009*^9, 3.75889406685902*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"deabb7f9-8630-4f53-af27-a1688383a3a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hMatrixAB", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"hMatrix", "+", 
         RowBox[{"V", " ", 
          RowBox[{"IdentityMatrix", "[", "4", "]"}]}]}], ",", 
        "hkInterLayer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Transpose", "[", "hkInterLayer", "]"}], ",", " ", 
        RowBox[{"hMatrix", "-", 
         RowBox[{"V", " ", 
          RowBox[{"IdentityMatrix", "[", "4", "]"}]}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.758607399881625*^9, 3.758607409347968*^9}, {
  3.7588773860486517`*^9, 3.758877391970302*^9}, {3.758894111804208*^9, 
  3.758894115895347*^9}, {3.758899493629436*^9, 3.758899501670021*^9}, {
  3.758900382857216*^9, 3.758900389328006*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"ca8b8f8d-2443-458f-ab89-afacc5d96a53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hMatrixAB", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"ExpToTrig", "[", "hMatrixAB", "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "t", ",", "ti", ",", "tr", ",", "tp", ",", "V", ",", "a", ",", "kx", 
         ",", "ky"}], "}"}], "\[Element]", "Reals"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.752624976801897*^9, 3.752625007651662*^9}, {
   3.7526251092344723`*^9, 3.752625109675497*^9}, {3.7526253401276784`*^9, 
   3.7526253696183653`*^9}, {3.7528013736313868`*^9, 3.752801378780396*^9}, {
   3.7528014979214096`*^9, 3.7528014994346123`*^9}, {3.752802747548994*^9, 
   3.7528027526346025`*^9}, {3.752802794629885*^9, 3.7528028172689257`*^9}, 
   3.757134878547551*^9, {3.757134953708483*^9, 3.7571349551748857`*^9}, {
   3.758606925997841*^9, 3.7586069370844603`*^9}, {3.758612412504127*^9, 
   3.758612412810732*^9}, {3.758877401696418*^9, 3.7588774055865726`*^9}, {
   3.7621086978770533`*^9, 3.762108699433364*^9}, {3.762231311052004*^9, 
   3.762231350401617*^9}, 3.762232786970957*^9, 3.775653035656855*^9, 
   3.775654165861332*^9},
 CellLabel->"",ExpressionUUID->"6da81ac9-cabb-426c-b046-280334169139"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve the eigenvalues;", "Subsubsection",
 CellChangeTimes->{{3.775653720796669*^9, 3.775653746573892*^9}, {
   3.7756542680030403`*^9, 3.775654275160618*^9}, 3.775654456861442*^9},
 Background->GrayLevel[
  0.85],ExpressionUUID->"97768d09-42bf-4aec-b2a5-0bc324c3671c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"spectrumAB", "=", 
   RowBox[{"Eigenvalues", "[", "hMatrixAB", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.757238770161957*^9, 3.757239058112463*^9, 3.757239094491727*^9, 
   3.7621093176579227`*^9, {3.762110232586213*^9, 3.76211023303301*^9}, 
   3.762110578234363*^9, {3.7622306086040163`*^9, 3.762230621457502*^9}, {
   3.762253549779736*^9, 3.7622535559412518`*^9}, {3.775654235940568*^9, 
   3.775654240958582*^9}},ExpressionUUID->"140766af-4274-42a9-9ca9-\
4aa93490a746"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"DumpSave", "[", 
   RowBox[{"\"\<EneSpecSOC.mx\>\"", ",", "spectrumAB"}], "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.762389295809257*^9, 3.7623893113435*^9}, {
  3.762390602831259*^9, 3.762390605522027*^9}, {3.77565301928161*^9, 
  3.775653026098667*^9}},ExpressionUUID->"cf32d7cc-ad98-4ddb-81c2-\
e315b476cfcb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Direction on BZ;", "Subsubsection",
 CellChangeTimes->{{3.775653720796669*^9, 3.775653746573892*^9}, {
   3.7756542680030403`*^9, 3.7756543016722393`*^9}, 3.7756544597096357`*^9},
 Background->GrayLevel[
  0.85],ExpressionUUID->"74114e4b-8c09-4ef2-b382-b518371c9736"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kLine", "[", 
   RowBox[{"dir_", ",", "Dk_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"DirVec", "=", 
      RowBox[{"-", 
       RowBox[{"Subtract", " ", "@@", " ", "dir"}]}]}], "}"}], ",", "    ", 
    RowBox[{"(*", " ", 
     RowBox[{"Direction", " ", "vector"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Nr", "=", 
      RowBox[{"Floor", "[", 
       FractionBox[
        RowBox[{"Norm", "[", "DirVec", "]"}], "Dk"], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Nr", " ", "of", " ", "sampling", " ", "points"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"NestList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Plus", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           FractionBox["1", "Nr"], "DirVec"}]}], "]"}], "&"}], ",", 
       RowBox[{"dir", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "Nr"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kPath", "[", 
   RowBox[{"path_", ",", "Dk_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"kLine", "[", 
     RowBox[{"#", ",", "Dk"}], "]"}], "&"}], " ", "/@", " ", 
   "path"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N\[CapitalGamma]", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";", " ", 
  RowBox[{"NK", "=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"4", "\[Pi]"}], 
      RowBox[{"3", 
       SqrtBox["3"]}]], ",", "0"}], "}"}]}], ";", " ", 
  RowBox[{"NM", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"2", "\[Pi]"}], "3"], 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       SqrtBox["3"], "2"], ",", 
      FractionBox["1", "2"]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7474699315812*^9, 3.7474699323144016`*^9}, 
   3.775654320687996*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"ac9320c0-4e5e-488f-8dd3-5a7b1f4a1cc1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[" Define functions for the Dispersion Relations;", "Subsubsection",
 CellChangeTimes->{{3.775653720796669*^9, 3.775653746573892*^9}, {
   3.7756542680030403`*^9, 3.7756543016722393`*^9}, {3.7756543466763163`*^9, 
   3.775654351232684*^9}, 3.775654463621608*^9},
 Background->GrayLevel[
  0.85],ExpressionUUID->"6514da88-1d28-4c5c-81fd-5b4ebd9ee6a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"EkBL", "[", "i", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"kx_", ",", "ky_"}], "}"}], "]"}], "=", 
      RowBox[{
       RowBox[{
       "spectrumAB", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "\[Rule]", "1"}], ",", 
         RowBox[{"t", "\[Rule]", "1"}], ",", 
         RowBox[{"tp", "\[Rule]", "0.2"}], ",", 
         RowBox[{"ti", "\[Rule]", "0.15"}], ",", 
         RowBox[{"tr", "\[Rule]", "0.28"}], " ", ",", 
         RowBox[{"V", "\[Rule]", "0.5"}]}], "}"}]}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"kPath", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"N\[CapitalGamma]", ",", "NM"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NM", ",", "NK"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NK", ",", "N\[CapitalGamma]"}], "}"}]}], "}"}], ",", ".01"}],
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.747469957664446*^9, 3.7474700479106045`*^9}, 
   3.757238972593113*^9, {3.757239143054612*^9, 3.757239174675868*^9}, {
   3.757239214440338*^9, 3.757239290927272*^9}, {3.758606958055153*^9, 
   3.758606983901388*^9}, 3.758607103303513*^9, {3.758607423586953*^9, 
   3.758607453300819*^9}, {3.758607874708683*^9, 3.7586079610260057`*^9}, {
   3.7586123947086163`*^9, 3.758612396163196*^9}, {3.75861246188899*^9, 
   3.758612462173069*^9}, {3.758612851598649*^9, 3.7586128679554663`*^9}, {
   3.758615191655732*^9, 3.758615199040765*^9}, {3.7587901549194317`*^9, 
   3.758790191192206*^9}, {3.758790265482374*^9, 3.758790266403265*^9}, {
   3.7587903087186337`*^9, 3.758790408897911*^9}, {3.758790466917386*^9, 
   3.7587904678628674`*^9}, 3.758790517165195*^9, {3.7587905586938467`*^9, 
   3.758790581803609*^9}, {3.758790628780612*^9, 3.758790662760125*^9}, {
   3.758790730450775*^9, 3.758790780925956*^9}, 3.75879083272075*^9, {
   3.7587908748323174`*^9, 3.758790989675407*^9}, {3.758791032233042*^9, 
   3.758791032752046*^9}, {3.758791139973007*^9, 3.75879115859485*^9}, 
   3.7587914528565807`*^9, {3.758791827552703*^9, 3.758791895942542*^9}, {
   3.7587919281936407`*^9, 3.758791953350752*^9}, {3.7587921168937693`*^9, 
   3.758792139809016*^9}, {3.758794704836013*^9, 3.758794705634754*^9}, {
   3.7587948208245373`*^9, 3.7587948244651012`*^9}, {3.758795202854484*^9, 
   3.75879523646861*^9}, {3.758801460408053*^9, 3.758801510345262*^9}, 
   3.7588017551114607`*^9, {3.758801805081002*^9, 3.758801833877816*^9}, {
   3.758801868080264*^9, 3.758801868358571*^9}, {3.758801983621793*^9, 
   3.758801992801597*^9}, {3.758812171408267*^9, 3.758812303660377*^9}, {
   3.7588443148791637`*^9, 3.7588443391828327`*^9}, {3.758844380599036*^9, 
   3.7588444255523777`*^9}, 3.758877529139297*^9, {3.758877639821514*^9, 
   3.758877737139619*^9}, {3.758877772961581*^9, 3.75887782892806*^9}, {
   3.758877863057208*^9, 3.758877917521533*^9}, {3.758877999535749*^9, 
   3.7588780145573263`*^9}, {3.758878045696239*^9, 3.758878046175494*^9}, {
   3.758878414537322*^9, 3.758878414796468*^9}, 3.758879491793644*^9, {
   3.758879635389638*^9, 3.758879654315481*^9}, {3.7588858798984137`*^9, 
   3.7588859159103193`*^9}, {3.758885971748334*^9, 3.758886000884165*^9}, {
   3.758895967247367*^9, 3.7588959729702044`*^9}, {3.758896099207058*^9, 
   3.7588960995608397`*^9}, 3.758896718133514*^9, {3.758896756543331*^9, 
   3.7588967783374557`*^9}, 3.758899279346093*^9, {3.7588994694596243`*^9, 
   3.7588994696896553`*^9}, {3.758899547290654*^9, 3.758899555144506*^9}, {
   3.7588996309119043`*^9, 3.758899657802947*^9}, {3.758899835261263*^9, 
   3.758899836457698*^9}, 3.758900108566128*^9, 3.758900251101302*^9, 
   3.758952909365821*^9, {3.7589536898838243`*^9, 3.758953693679311*^9}, {
   3.758959799692593*^9, 3.758959873554057*^9}, {3.7589599119784327`*^9, 
   3.758959936450873*^9}, {3.758960024538307*^9, 3.758960026339217*^9}, {
   3.7589600780882607`*^9, 3.7589600919763803`*^9}, {3.758980308856839*^9, 
   3.758980309138237*^9}, {3.758980499414888*^9, 3.758980501501916*^9}, {
   3.7589805892508163`*^9, 3.7589806396847353`*^9}, {3.758980674205063*^9, 
   3.758980684817219*^9}, {3.758980994397992*^9, 3.75898107346041*^9}, {
   3.75898968681437*^9, 3.758989687761812*^9}, 3.758992157977129*^9, {
   3.7590323156870213`*^9, 3.75903231824009*^9}, {3.759032460586618*^9, 
   3.7590324614462767`*^9}, {3.7590325749934998`*^9, 3.759032615333149*^9}, {
   3.759032657428912*^9, 3.759032694733086*^9}, {3.759032727544305*^9, 
   3.759032738024287*^9}, {3.7590327899568853`*^9, 3.759032837109487*^9}, {
   3.759032881941236*^9, 3.75903300678631*^9}, {3.759034079999251*^9, 
   3.759034130720704*^9}, {3.759034188165172*^9, 3.759034246389995*^9}, {
   3.7590343454379053`*^9, 3.759034388527438*^9}, {3.759034433044626*^9, 
   3.759034461421427*^9}, {3.759034518785741*^9, 3.7590345729401693`*^9}, {
   3.759034615807476*^9, 3.759034689175309*^9}, {3.759034731098566*^9, 
   3.759034820134255*^9}, {3.759034956043089*^9, 3.75903497024994*^9}, 
   3.759035002449287*^9, {3.759035079821162*^9, 3.7590351298652983`*^9}, {
   3.759035299689846*^9, 3.759035349632944*^9}, {3.759035435386723*^9, 
   3.759035437888142*^9}, {3.7592072185720034`*^9, 3.759207225128065*^9}, {
   3.7592073915527253`*^9, 3.7592074029088*^9}, 3.759207486400474*^9, {
   3.7592076410423126`*^9, 3.759207667716977*^9}, {3.759207702950782*^9, 
   3.7592077695427284`*^9}, 3.759207970359373*^9, 3.759208021762169*^9, 
   3.759208168843852*^9, 3.7592082344070883`*^9, {3.7592082787607975`*^9, 
   3.7592082897357225`*^9}, {3.759208331763815*^9, 3.7592084648096247`*^9}, {
   3.759208530965337*^9, 3.759208590980654*^9}, {3.759312250894164*^9, 
   3.7593122714781237`*^9}, {3.759312544763007*^9, 3.759312548538897*^9}, {
   3.7593126634180527`*^9, 3.75931266387201*^9}, {3.759314793528247*^9, 
   3.759314800268032*^9}, {3.75931490078062*^9, 3.75931490104937*^9}, 
   3.7605891461183767`*^9, 3.760589720339711*^9, 3.760589863191988*^9, 
   3.7605900506683702`*^9, {3.760590413555859*^9, 3.760590413742968*^9}, {
   3.7605905332730627`*^9, 3.760590537254773*^9}, 3.760590660774456*^9, 
   3.760590795150798*^9, {3.762108712992578*^9, 3.762108718080154*^9}, {
   3.762108850924858*^9, 3.762108852323105*^9}, 3.762109222667387*^9, 
   3.7621093647892847`*^9, {3.7622713285354757`*^9, 3.762271330112823*^9}, {
   3.762301857894133*^9, 3.7623018585493507`*^9}, {3.762305173381774*^9, 
   3.762305175597334*^9}, {3.7623064826200027`*^9, 3.7623064829953537`*^9}, 
   3.7623073889364443`*^9, {3.762319388125448*^9, 3.762319388254582*^9}, {
   3.76232078989634*^9, 3.762320790105204*^9}, {3.762322098744131*^9, 
   3.762322099046986*^9}, 3.762324011147048*^9, {3.762324942719576*^9, 
   3.76232494299921*^9}, 3.7623274446502934`*^9, 3.775654392739182*^9, {
   3.775654833010504*^9, 
   3.775654853263583*^9}},ExpressionUUID->"2a319008-0b79-42b5-95e4-\
83be9a842205"]
}, Open  ]],

Cell[CellGroupData[{

Cell[" Apply the dispersion relation to the k-space mesh,", "Subsubsection",
 CellChangeTimes->{{3.775653954187161*^9, 3.775653965346616*^9}, {
   3.775654077627201*^9, 3.775654089568033*^9}, {3.775654416636179*^9, 
   3.77565442213186*^9}, {3.775654467139065*^9, 3.7756544677640953`*^9}, 
   3.775654576315318*^9},
 FontSize->14,
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"a25f9c07-efca-4e18-a625-20879fd661cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Band1", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{"EkBL", "[", "1", "]"}], ",", "temp", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Band2", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{"EkBL", "[", "2", "]"}], ",", "temp", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Band3", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{"EkBL", "[", "3", "]"}], ",", "temp", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Band4", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{"EkBL", "[", "4", "]"}], ",", "temp", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Band5", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{"EkBL", "[", "5", "]"}], ",", "temp", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Band6", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{"EkBL", "[", "6", "]"}], ",", "temp", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Band7", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{"EkBL", "[", "7", "]"}], ",", "temp", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Band8", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{"EkBL", "[", "8", "]"}], ",", "temp", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.747469957664446*^9, 3.7474700479106045`*^9}, 
   3.757238972593113*^9, {3.757239143054612*^9, 3.757239174675868*^9}, {
   3.757239214440338*^9, 3.757239290927272*^9}, {3.758606958055153*^9, 
   3.758606983901388*^9}, 3.758607103303513*^9, {3.758607423586953*^9, 
   3.758607453300819*^9}, {3.758607874708683*^9, 3.7586079610260057`*^9}, {
   3.7586123947086163`*^9, 3.758612396163196*^9}, {3.75861246188899*^9, 
   3.758612462173069*^9}, {3.758612851598649*^9, 3.7586128679554663`*^9}, {
   3.758615191655732*^9, 3.758615199040765*^9}, {3.7587901549194317`*^9, 
   3.758790191192206*^9}, {3.758790265482374*^9, 3.758790266403265*^9}, {
   3.7587903087186337`*^9, 3.758790408897911*^9}, {3.758790466917386*^9, 
   3.7587904678628674`*^9}, 3.758790517165195*^9, {3.7587905586938467`*^9, 
   3.758790581803609*^9}, {3.758790628780612*^9, 3.758790662760125*^9}, {
   3.758790730450775*^9, 3.758790780925956*^9}, 3.75879083272075*^9, {
   3.7587908748323174`*^9, 3.758790989675407*^9}, {3.758791032233042*^9, 
   3.758791032752046*^9}, {3.758791139973007*^9, 3.75879115859485*^9}, 
   3.7587914528565807`*^9, {3.758791827552703*^9, 3.758791895942542*^9}, {
   3.7587919281936407`*^9, 3.758791953350752*^9}, {3.7587921168937693`*^9, 
   3.758792139809016*^9}, {3.758794704836013*^9, 3.758794705634754*^9}, {
   3.7587948208245373`*^9, 3.7587948244651012`*^9}, {3.758795202854484*^9, 
   3.75879523646861*^9}, {3.758801460408053*^9, 3.758801510345262*^9}, 
   3.7588017551114607`*^9, {3.758801805081002*^9, 3.758801833877816*^9}, {
   3.758801868080264*^9, 3.758801868358571*^9}, {3.758801983621793*^9, 
   3.758801992801597*^9}, {3.758812171408267*^9, 3.758812303660377*^9}, {
   3.7588443148791637`*^9, 3.7588443391828327`*^9}, {3.758844380599036*^9, 
   3.7588444255523777`*^9}, 3.758877529139297*^9, {3.758877639821514*^9, 
   3.758877737139619*^9}, {3.758877772961581*^9, 3.75887782892806*^9}, {
   3.758877863057208*^9, 3.758877917521533*^9}, {3.758877999535749*^9, 
   3.7588780145573263`*^9}, {3.758878045696239*^9, 3.758878046175494*^9}, {
   3.758878414537322*^9, 3.758878414796468*^9}, 3.758879491793644*^9, {
   3.758879635389638*^9, 3.758879654315481*^9}, {3.7588858798984137`*^9, 
   3.7588859159103193`*^9}, {3.758885971748334*^9, 3.758886000884165*^9}, {
   3.758895967247367*^9, 3.7588959729702044`*^9}, {3.758896099207058*^9, 
   3.7588960995608397`*^9}, 3.758896718133514*^9, {3.758896756543331*^9, 
   3.7588967783374557`*^9}, 3.758899279346093*^9, {3.7588994694596243`*^9, 
   3.7588994696896553`*^9}, {3.758899547290654*^9, 3.758899555144506*^9}, {
   3.7588996309119043`*^9, 3.758899657802947*^9}, {3.758899835261263*^9, 
   3.758899836457698*^9}, 3.758900108566128*^9, 3.758900251101302*^9, 
   3.758952909365821*^9, {3.7589536898838243`*^9, 3.758953693679311*^9}, {
   3.758959799692593*^9, 3.758959873554057*^9}, {3.7589599119784327`*^9, 
   3.758959936450873*^9}, {3.758960024538307*^9, 3.758960026339217*^9}, {
   3.7589600780882607`*^9, 3.7589600919763803`*^9}, {3.758980308856839*^9, 
   3.758980309138237*^9}, {3.758980499414888*^9, 3.758980501501916*^9}, {
   3.7589805892508163`*^9, 3.7589806396847353`*^9}, {3.758980674205063*^9, 
   3.758980684817219*^9}, {3.758980994397992*^9, 3.75898107346041*^9}, {
   3.75898968681437*^9, 3.758989687761812*^9}, 3.758992157977129*^9, {
   3.7590323156870213`*^9, 3.75903231824009*^9}, {3.759032460586618*^9, 
   3.7590324614462767`*^9}, {3.7590325749934998`*^9, 3.759032615333149*^9}, {
   3.759032657428912*^9, 3.759032694733086*^9}, {3.759032727544305*^9, 
   3.759032738024287*^9}, {3.7590327899568853`*^9, 3.759032837109487*^9}, {
   3.759032881941236*^9, 3.75903300678631*^9}, {3.759034079999251*^9, 
   3.759034130720704*^9}, {3.759034188165172*^9, 3.759034246389995*^9}, {
   3.7590343454379053`*^9, 3.759034388527438*^9}, {3.759034433044626*^9, 
   3.759034461421427*^9}, {3.759034518785741*^9, 3.7590345729401693`*^9}, {
   3.759034615807476*^9, 3.759034689175309*^9}, {3.759034731098566*^9, 
   3.759034820134255*^9}, {3.759034956043089*^9, 3.75903497024994*^9}, 
   3.759035002449287*^9, {3.759035079821162*^9, 3.7590351298652983`*^9}, {
   3.759035299689846*^9, 3.759035349632944*^9}, {3.759035435386723*^9, 
   3.759035437888142*^9}, {3.7592072185720034`*^9, 3.759207225128065*^9}, {
   3.7592073915527253`*^9, 3.7592074029088*^9}, 3.759207486400474*^9, {
   3.7592076410423126`*^9, 3.759207667716977*^9}, {3.759207702950782*^9, 
   3.7592077695427284`*^9}, 3.759207970359373*^9, 3.759208021762169*^9, 
   3.759208168843852*^9, 3.7592082344070883`*^9, {3.7592082787607975`*^9, 
   3.7592082897357225`*^9}, {3.759208331763815*^9, 3.7592084648096247`*^9}, {
   3.759208530965337*^9, 3.759208590980654*^9}, {3.759312250894164*^9, 
   3.7593122714781237`*^9}, 3.760589072639771*^9, 3.760589129770156*^9, {
   3.760589233774987*^9, 3.76058926443332*^9}, {3.7605892993379993`*^9, 
   3.760589308223364*^9}, {3.760589494932438*^9, 3.760589546617754*^9}, {
   3.760589577951783*^9, 3.760589645750073*^9}, 3.760589747148101*^9, 
   3.760589850521616*^9, 3.760590057811661*^9, {3.760590402867199*^9, 
   3.760590403112306*^9}, {3.76059054556168*^9, 3.760590548322404*^9}, 
   3.760590679672845*^9, 3.760590790353141*^9, {3.762230666441284*^9, 
   3.76223069057901*^9}, {3.762271038721342*^9, 3.76227106380632*^9}, {
   3.762302874170226*^9, 3.762302885401512*^9}, {3.762303426990448*^9, 
   3.7623034335364113`*^9}, {3.76230422297899*^9, 3.762304223609617*^9}, {
   3.762304320818989*^9, 3.762304322979295*^9}, {3.7623051534743958`*^9, 
   3.762305155284511*^9}, {3.762306477606617*^9, 3.762306478240939*^9}, 
   3.762307378510809*^9, {3.762319375530957*^9, 3.762319383907592*^9}, {
   3.762320794846425*^9, 3.762320795054137*^9}, {3.7623221035816936`*^9, 
   3.7623221038678713`*^9}, 3.762324007304166*^9, {3.7623249381107492`*^9, 
   3.7623249386706457`*^9}, 3.7623274408400497`*^9, {3.775652962874999*^9, 
   3.775652976394395*^9}, {3.775654381116357*^9, 3.7756544104355173`*^9}, {
   3.775654477364819*^9, 
   3.775654487505265*^9}},ExpressionUUID->"716be177-6efa-4304-819d-\
9ae074cd4160"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extra polish to put the labels in the right position.", "Subsubsection",
 CellChangeTimes->{{3.775653954187161*^9, 3.775653965346616*^9}, {
   3.775654077627201*^9, 3.775654089568033*^9}, {3.775654416636179*^9, 
   3.77565442213186*^9}, {3.775654467139065*^9, 3.7756544677640953`*^9}, {
   3.7756545186176662`*^9, 3.775654525685854*^9}, 3.775654572083727*^9, {
   3.7756546177228937`*^9, 3.775654618064273*^9}},
 FontSize->14,
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"fd7933bd-43a9-4276-a0fe-daa183629f3a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tick0", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\"\<\[CapitalGamma]\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tick1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ii", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"temp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        "]"}]}], ",", "\"\<M\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tick2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ii", " ", "+=", " ", 
      RowBox[{"Length", "[", 
       RowBox[{"temp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
        "]"}]}], ",", "\"\<K\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tick3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ii", " ", "+=", " ", 
      RowBox[{"Length", "[", 
       RowBox[{"temp", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
        "]"}]}], ",", "\"\<\[CapitalGamma]\>\""}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.747469957664446*^9, 3.7474700479106045`*^9}, 
   3.757238972593113*^9, {3.757239143054612*^9, 3.757239174675868*^9}, {
   3.757239214440338*^9, 3.757239290927272*^9}, {3.758606958055153*^9, 
   3.758606983901388*^9}, 3.758607103303513*^9, {3.758607423586953*^9, 
   3.758607453300819*^9}, {3.758607874708683*^9, 3.7586079610260057`*^9}, {
   3.7586123947086163`*^9, 3.758612396163196*^9}, {3.75861246188899*^9, 
   3.758612462173069*^9}, {3.758612851598649*^9, 3.7586128679554663`*^9}, {
   3.758615191655732*^9, 3.758615199040765*^9}, {3.7587901549194317`*^9, 
   3.758790191192206*^9}, {3.758790265482374*^9, 3.758790266403265*^9}, {
   3.7587903087186337`*^9, 3.758790408897911*^9}, {3.758790466917386*^9, 
   3.7587904678628674`*^9}, 3.758790517165195*^9, {3.7587905586938467`*^9, 
   3.758790581803609*^9}, {3.758790628780612*^9, 3.758790662760125*^9}, {
   3.758790730450775*^9, 3.758790780925956*^9}, 3.75879083272075*^9, {
   3.7587908748323174`*^9, 3.758790989675407*^9}, {3.758791032233042*^9, 
   3.758791032752046*^9}, {3.758791139973007*^9, 3.75879115859485*^9}, 
   3.7587914528565807`*^9, {3.758791827552703*^9, 3.758791895942542*^9}, {
   3.7587919281936407`*^9, 3.758791953350752*^9}, {3.7587921168937693`*^9, 
   3.758792139809016*^9}, {3.758794704836013*^9, 3.758794705634754*^9}, {
   3.7587948208245373`*^9, 3.7587948244651012`*^9}, {3.758795202854484*^9, 
   3.75879523646861*^9}, {3.758801460408053*^9, 3.758801510345262*^9}, 
   3.7588017551114607`*^9, {3.758801805081002*^9, 3.758801833877816*^9}, {
   3.758801868080264*^9, 3.758801868358571*^9}, {3.758801983621793*^9, 
   3.758801992801597*^9}, {3.758812171408267*^9, 3.758812303660377*^9}, {
   3.7588443148791637`*^9, 3.7588443391828327`*^9}, {3.758844380599036*^9, 
   3.7588444255523777`*^9}, 3.758877529139297*^9, {3.758877639821514*^9, 
   3.758877737139619*^9}, {3.758877772961581*^9, 3.75887782892806*^9}, {
   3.758877863057208*^9, 3.758877917521533*^9}, {3.758877999535749*^9, 
   3.7588780145573263`*^9}, {3.758878045696239*^9, 3.758878046175494*^9}, {
   3.758878414537322*^9, 3.758878414796468*^9}, 3.758879491793644*^9, {
   3.758879635389638*^9, 3.758879654315481*^9}, {3.7588858798984137`*^9, 
   3.7588859159103193`*^9}, {3.758885971748334*^9, 3.758886000884165*^9}, {
   3.758895967247367*^9, 3.7588959729702044`*^9}, {3.758896099207058*^9, 
   3.7588960995608397`*^9}, 3.758896718133514*^9, {3.758896756543331*^9, 
   3.7588967783374557`*^9}, 3.758899279346093*^9, {3.7588994694596243`*^9, 
   3.7588994696896553`*^9}, {3.758899547290654*^9, 3.758899555144506*^9}, {
   3.7588996309119043`*^9, 3.758899657802947*^9}, {3.758899835261263*^9, 
   3.758899836457698*^9}, 3.758900108566128*^9, 3.758900251101302*^9, 
   3.758952909365821*^9, {3.7589536898838243`*^9, 3.758953693679311*^9}, {
   3.758959799692593*^9, 3.758959873554057*^9}, {3.7589599119784327`*^9, 
   3.758959936450873*^9}, {3.758960024538307*^9, 3.758960026339217*^9}, {
   3.7589600780882607`*^9, 3.7589600919763803`*^9}, {3.758980308856839*^9, 
   3.758980309138237*^9}, {3.758980499414888*^9, 3.758980501501916*^9}, {
   3.7589805892508163`*^9, 3.7589806396847353`*^9}, {3.758980674205063*^9, 
   3.758980684817219*^9}, {3.758980994397992*^9, 3.75898107346041*^9}, {
   3.75898968681437*^9, 3.758989687761812*^9}, 3.758992157977129*^9, {
   3.7590323156870213`*^9, 3.75903231824009*^9}, {3.759032460586618*^9, 
   3.7590324614462767`*^9}, {3.7590325749934998`*^9, 3.759032615333149*^9}, {
   3.759032657428912*^9, 3.759032694733086*^9}, {3.759032727544305*^9, 
   3.759032738024287*^9}, {3.7590327899568853`*^9, 3.759032837109487*^9}, {
   3.759032881941236*^9, 3.75903300678631*^9}, {3.759034079999251*^9, 
   3.759034130720704*^9}, {3.759034188165172*^9, 3.759034246389995*^9}, {
   3.7590343454379053`*^9, 3.759034388527438*^9}, {3.759034433044626*^9, 
   3.759034461421427*^9}, {3.759034518785741*^9, 3.7590345729401693`*^9}, {
   3.759034615807476*^9, 3.759034689175309*^9}, {3.759034731098566*^9, 
   3.759034820134255*^9}, {3.759034956043089*^9, 3.75903497024994*^9}, 
   3.759035002449287*^9, {3.759035079821162*^9, 3.7590351298652983`*^9}, {
   3.759035299689846*^9, 3.759035349632944*^9}, {3.759035435386723*^9, 
   3.759035437888142*^9}, {3.7592072185720034`*^9, 3.759207225128065*^9}, {
   3.7592073915527253`*^9, 3.7592074029088*^9}, 3.759207486400474*^9, {
   3.7592076410423126`*^9, 3.759207667716977*^9}, {3.759207702950782*^9, 
   3.7592077695427284`*^9}, 3.759207970359373*^9, 3.759208021762169*^9, 
   3.759208168843852*^9, 3.7592082344070883`*^9, {3.7592082787607975`*^9, 
   3.7592082897357225`*^9}, {3.759208331763815*^9, 3.7592084648096247`*^9}, {
   3.759208530965337*^9, 3.759208590980654*^9}, {3.759312250894164*^9, 
   3.7593122714781237`*^9}, 3.760589072639771*^9, 3.760589129770156*^9, {
   3.760589233774987*^9, 3.76058926443332*^9}, {3.7605892993379993`*^9, 
   3.760589308223364*^9}, {3.760589494932438*^9, 3.760589546617754*^9}, {
   3.760589577951783*^9, 3.760589645750073*^9}, 3.760589747148101*^9, 
   3.760589850521616*^9, 3.760590057811661*^9, {3.760590402867199*^9, 
   3.760590403112306*^9}, {3.76059054556168*^9, 3.760590548322404*^9}, 
   3.760590679672845*^9, 3.760590790353141*^9, {3.762230666441284*^9, 
   3.76223069057901*^9}, {3.762271038721342*^9, 3.76227106380632*^9}, {
   3.762302874170226*^9, 3.762302885401512*^9}, {3.762303426990448*^9, 
   3.7623034335364113`*^9}, {3.76230422297899*^9, 3.762304223609617*^9}, {
   3.762304320818989*^9, 3.762304322979295*^9}, {3.7623051534743958`*^9, 
   3.762305155284511*^9}, {3.762306477606617*^9, 3.762306478240939*^9}, 
   3.762307378510809*^9, {3.762319375530957*^9, 3.762319383907592*^9}, {
   3.762320794846425*^9, 3.762320795054137*^9}, {3.7623221035816936`*^9, 
   3.7623221038678713`*^9}, 3.762324007304166*^9, {3.7623249381107492`*^9, 
   3.7623249386706457`*^9}, 3.7623274408400497`*^9, {3.775652962874999*^9, 
   3.775652976394395*^9}, {3.775654381116357*^9, 3.7756544104355173`*^9}, {
   3.775654477364819*^9, 
   3.775654533739813*^9}},ExpressionUUID->"e9baff8d-1c15-41ee-94a3-\
d172bceaf514"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot the dispersion;", "Subsubsection",
 CellChangeTimes->{
  3.775653527464106*^9, 3.775654449110611*^9, {3.775654677176194*^9, 
   3.775654686672935*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"f3a2ecfa-0037-4fc3-a5fd-10b3b6401caf"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "Band1", ",", "Band2", ",", "Band3", ",", "Band4", ",", "Band5", ",", 
     "Band6", ",", "Band7", ",", "Band8"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Thickness", "[", "0.0035", "]"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tick0", ",", "tick1", ",", "tick2", ",", "tick3"}], "}"}], 
      ",", "Automatic"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<t=1  tr=0.2 \>\"", ",", "28", ",", "Bold"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Scaled", "[", 
         RowBox[{"{", 
          RowBox[{"0.01", ",", "0.98"}], "}"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0.8"}], "}"}]}], "}"}]}], "]"}]}], ",", 
   RowBox[{"LabelStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"40", ",", 
      RowBox[{"GrayLevel", "[", "0", "]"}], ",", "Bold"}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.747469957664446*^9, 3.7474700479106045`*^9}, 
   3.757238972593113*^9, {3.757239143054612*^9, 3.757239174675868*^9}, {
   3.757239214440338*^9, 3.757239290927272*^9}, {3.758606958055153*^9, 
   3.758606983901388*^9}, 3.758607103303513*^9, {3.758607423586953*^9, 
   3.758607453300819*^9}, {3.758607874708683*^9, 3.7586079610260057`*^9}, {
   3.7586123947086163`*^9, 3.758612396163196*^9}, {3.75861246188899*^9, 
   3.758612462173069*^9}, {3.758612851598649*^9, 3.7586128679554663`*^9}, {
   3.758615191655732*^9, 3.758615199040765*^9}, {3.7587901549194317`*^9, 
   3.758790191192206*^9}, {3.758790265482374*^9, 3.758790266403265*^9}, {
   3.7587903087186337`*^9, 3.758790408897911*^9}, {3.758790466917386*^9, 
   3.7587904678628674`*^9}, 3.758790517165195*^9, {3.7587905586938467`*^9, 
   3.758790581803609*^9}, {3.758790628780612*^9, 3.758790662760125*^9}, {
   3.758790730450775*^9, 3.758790780925956*^9}, 3.75879083272075*^9, {
   3.7587908748323174`*^9, 3.758790989675407*^9}, {3.758791032233042*^9, 
   3.758791032752046*^9}, {3.758791139973007*^9, 3.75879115859485*^9}, 
   3.7587914528565807`*^9, {3.758791827552703*^9, 3.758791895942542*^9}, {
   3.7587919281936407`*^9, 3.758791953350752*^9}, {3.7587921168937693`*^9, 
   3.758792139809016*^9}, {3.758794704836013*^9, 3.758794705634754*^9}, {
   3.7587948208245373`*^9, 3.7587948244651012`*^9}, {3.758795202854484*^9, 
   3.75879523646861*^9}, {3.758801460408053*^9, 3.758801510345262*^9}, 
   3.7588017551114607`*^9, {3.758801805081002*^9, 3.758801833877816*^9}, {
   3.758801868080264*^9, 3.758801868358571*^9}, {3.758801983621793*^9, 
   3.758801992801597*^9}, {3.758812171408267*^9, 3.758812303660377*^9}, {
   3.7588443148791637`*^9, 3.7588443391828327`*^9}, {3.758844380599036*^9, 
   3.7588444255523777`*^9}, 3.758877529139297*^9, {3.758877639821514*^9, 
   3.758877737139619*^9}, {3.758877772961581*^9, 3.75887782892806*^9}, {
   3.758877863057208*^9, 3.758877917521533*^9}, {3.758877999535749*^9, 
   3.7588780145573263`*^9}, {3.758878045696239*^9, 3.758878046175494*^9}, {
   3.758878414537322*^9, 3.758878414796468*^9}, 3.758879491793644*^9, {
   3.758879635389638*^9, 3.758879654315481*^9}, {3.7588858798984137`*^9, 
   3.7588859159103193`*^9}, {3.758885971748334*^9, 3.758886000884165*^9}, {
   3.758895967247367*^9, 3.7588959729702044`*^9}, {3.758896099207058*^9, 
   3.7588960995608397`*^9}, 3.758896718133514*^9, {3.758896756543331*^9, 
   3.7588967783374557`*^9}, 3.758899279346093*^9, {3.7588994694596243`*^9, 
   3.7588994696896553`*^9}, {3.758899547290654*^9, 3.758899555144506*^9}, {
   3.7588996309119043`*^9, 3.758899657802947*^9}, {3.758899835261263*^9, 
   3.758899836457698*^9}, 3.758900108566128*^9, 3.758900251101302*^9, 
   3.758952909365821*^9, {3.7589536898838243`*^9, 3.758953693679311*^9}, {
   3.758959799692593*^9, 3.758959873554057*^9}, {3.7589599119784327`*^9, 
   3.758959936450873*^9}, {3.758960024538307*^9, 3.758960026339217*^9}, {
   3.7589600780882607`*^9, 3.7589600919763803`*^9}, {3.758980308856839*^9, 
   3.758980309138237*^9}, {3.758980499414888*^9, 3.758980501501916*^9}, {
   3.7589805892508163`*^9, 3.7589806396847353`*^9}, {3.758980674205063*^9, 
   3.758980684817219*^9}, {3.758980994397992*^9, 3.75898107346041*^9}, {
   3.75898968681437*^9, 3.758989687761812*^9}, 3.758992157977129*^9, {
   3.7590323156870213`*^9, 3.75903231824009*^9}, {3.759032460586618*^9, 
   3.7590324614462767`*^9}, {3.7590325749934998`*^9, 3.759032615333149*^9}, {
   3.759032657428912*^9, 3.759032694733086*^9}, {3.759032727544305*^9, 
   3.759032738024287*^9}, {3.7590327899568853`*^9, 3.759032837109487*^9}, {
   3.759032881941236*^9, 3.75903300678631*^9}, {3.759034079999251*^9, 
   3.759034130720704*^9}, {3.759034188165172*^9, 3.759034246389995*^9}, {
   3.7590343454379053`*^9, 3.759034388527438*^9}, {3.759034433044626*^9, 
   3.759034461421427*^9}, {3.759034518785741*^9, 3.7590345729401693`*^9}, {
   3.759034615807476*^9, 3.759034689175309*^9}, {3.759034731098566*^9, 
   3.759034820134255*^9}, {3.759034956043089*^9, 3.75903497024994*^9}, 
   3.759035002449287*^9, {3.759035079821162*^9, 3.7590351298652983`*^9}, {
   3.759035299689846*^9, 3.759035349632944*^9}, {3.759035435386723*^9, 
   3.759035437888142*^9}, {3.7592072185720034`*^9, 3.759207225128065*^9}, {
   3.7592073915527253`*^9, 3.7592074029088*^9}, 3.759207486400474*^9, {
   3.7592076410423126`*^9, 3.759207667716977*^9}, {3.759207702950782*^9, 
   3.7592077695427284`*^9}, 3.759207970359373*^9, 3.759208021762169*^9, 
   3.759208168843852*^9, 3.7592082344070883`*^9, {3.7592082787607975`*^9, 
   3.7592082897357225`*^9}, {3.759208331763815*^9, 3.7592084648096247`*^9}, {
   3.759208530965337*^9, 3.759208590980654*^9}, {3.759312250894164*^9, 
   3.7593122714781237`*^9}, 3.760589072639771*^9, 3.760589129770156*^9, {
   3.760589233774987*^9, 3.76058926443332*^9}, {3.7605892993379993`*^9, 
   3.760589308223364*^9}, {3.760589494932438*^9, 3.760589546617754*^9}, {
   3.760589577951783*^9, 3.760589645750073*^9}, 3.760589747148101*^9, 
   3.760589850521616*^9, 3.760590057811661*^9, {3.760590402867199*^9, 
   3.760590403112306*^9}, {3.76059054556168*^9, 3.760590548322404*^9}, 
   3.760590679672845*^9, 3.760590790353141*^9, {3.762230666441284*^9, 
   3.76223069057901*^9}, {3.762271038721342*^9, 3.76227106380632*^9}, {
   3.762302874170226*^9, 3.762302885401512*^9}, {3.762303426990448*^9, 
   3.7623034335364113`*^9}, {3.76230422297899*^9, 3.762304223609617*^9}, {
   3.762304320818989*^9, 3.762304322979295*^9}, {3.7623051534743958`*^9, 
   3.762305155284511*^9}, {3.762306477606617*^9, 3.762306478240939*^9}, 
   3.762307378510809*^9, {3.762319375530957*^9, 3.762319383907592*^9}, {
   3.762320794846425*^9, 3.762320795054137*^9}, {3.7623221035816936`*^9, 
   3.7623221038678713`*^9}, 3.762324007304166*^9, {3.7623249381107492`*^9, 
   3.7623249386706457`*^9}, 3.7623274408400497`*^9, {3.775652962874999*^9, 
   3.775652976394395*^9}, {3.775654381116357*^9, 3.7756544104355173`*^9}, {
   3.775654477364819*^9, 3.7756545595747347`*^9}, {3.77565460061259*^9, 
   3.775654600872213*^9}},ExpressionUUID->"e048d559-56c5-46c0-9b8c-\
5827f3c52ae9"]
}, Open  ]]
},
WindowSize->{1334, 709},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 325, 5, 73, "Subsubsection",ExpressionUUID->"320aea46-9812-4d7f-b7fd-c50bb06b68b6"],
Cell[908, 29, 2477, 40, 78, "Input",ExpressionUUID->"0a2c22de-36d5-421b-8907-aab276a9d1b4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3422, 74, 247, 5, 61, "Subsubsection",ExpressionUUID->"bfa3e814-7027-4d28-97d6-3c8129d7f4d0"],
Cell[3672, 81, 4282, 98, 150, "Input",ExpressionUUID->"eca7f318-e3b2-40b0-8b06-d533bb7402a9"]
}, Open  ]],
Cell[7969, 182, 238, 4, 61, "Subsubsection",ExpressionUUID->"48fdbcb2-f864-4b37-ba70-e00f3b44d4d7"],
Cell[CellGroupData[{
Cell[8232, 190, 302, 5, 47, "Subsubsection",ExpressionUUID->"777ea59e-a9aa-4065-848a-82bd8978bc04"],
Cell[8537, 197, 3577, 64, 31, "Input",ExpressionUUID->"87af1a62-f588-4db6-9739-a0feb7b0a0b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12151, 266, 320, 5, 55, "Subsubsection",ExpressionUUID->"2df4d14c-995b-48fa-ac9a-891a304bf544"],
Cell[12474, 273, 4384, 90, 31, "Input",ExpressionUUID->"7d96752e-a1d3-4776-8535-f2534da24025"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16895, 368, 342, 6, 55, "Subsubsection",ExpressionUUID->"b7ea74eb-ba92-4abb-b55e-b7f54a3b2d78"],
Cell[17240, 376, 5184, 120, 138, "Input",ExpressionUUID->"12726435-46fb-46b7-8eb4-aeffb3e295d4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22461, 501, 300, 4, 61, "Subsubsection",ExpressionUUID->"b94bd2bc-51ab-4f39-a733-75ff3a989628"],
Cell[22764, 507, 4452, 99, 193, "Input",ExpressionUUID->"f134a2f8-f872-4295-ae0c-2cb2c01124c3"],
Cell[27219, 608, 828, 21, 124, "Input",ExpressionUUID->"deabb7f9-8630-4f53-af27-a1688383a3a0"],
Cell[28050, 631, 979, 23, 78, "Input",ExpressionUUID->"ca8b8f8d-2443-458f-ab89-afacc5d96a53"],
Cell[29032, 656, 1250, 24, 31, "Input",ExpressionUUID->"6da81ac9-cabb-426c-b046-280334169139"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30319, 685, 275, 4, 61, "Subsubsection",ExpressionUUID->"97768d09-42bf-4aec-b2a5-0bc324c3671c"],
Cell[30597, 691, 518, 10, 31, "Input",ExpressionUUID->"140766af-4274-42a9-9ca9-4aa93490a746"],
Cell[31118, 703, 360, 8, 31, "Input",ExpressionUUID->"cf32d7cc-ad98-4ddb-81c2-e315b476cfcb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31515, 716, 273, 4, 61, "Subsubsection",ExpressionUUID->"74114e4b-8c09-4ef2-b382-b518371c9736"],
Cell[31791, 722, 2027, 61, 307, "Input",ExpressionUUID->"ac9320c0-4e5e-488f-8dd3-5a7b1f4a1cc1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33855, 788, 354, 5, 61, "Subsubsection",ExpressionUUID->"6514da88-1d28-4c5c-81fd-5b4ebd9ee6a7"],
Cell[34212, 795, 7156, 118, 101, "Input",ExpressionUUID->"2a319008-0b79-42b5-95e4-83be9a842205"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41405, 918, 426, 7, 55, "Subsubsection",ExpressionUUID->"a25f9c07-efca-4e18-a625-20879fd661cf"],
Cell[41834, 927, 8022, 148, 216, "Input",ExpressionUUID->"716be177-6efa-4304-819d-9ae074cd4160"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49893, 1080, 528, 8, 55, "Subsubsection",ExpressionUUID->"fd7933bd-43a9-4276-a0fe-daa183629f3a"],
Cell[50424, 1090, 7097, 113, 101, "Input",ExpressionUUID->"e9baff8d-1c15-41ee-94a3-d172bceaf514"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57558, 1208, 250, 5, 61, "Subsubsection",ExpressionUUID->"f3a2ecfa-0037-4fc3-a5fd-10b3b6401caf"],
Cell[57811, 1215, 7442, 119, 101, "Input",ExpressionUUID->"e048d559-56c5-46c0-9b8c-5827f3c52ae9"]
}, Open  ]]
}
]
*)

